# ConvertMapGIS

ä¸€ä¸ªåŸºäºPythonçš„MapGISæ–‡ä»¶è½¬æ¢å·¥å…·ï¼Œæ”¯æŒå°†MapGISæ ¼å¼æ–‡ä»¶è½¬æ¢ä¸ºShapefileæ ¼å¼ã€‚

## è½¯ä»¶ç•Œé¢

### ä¸»ç•Œé¢

![æ—¥å¿—ç•Œé¢](https://vip.123pan.cn/1830392062/ymjew503t0n000d7w32y6qzrq1iw0xvtDIYwDdD2DqazDpxPDwJy.png)

### æ—¥å¿—ç•Œé¢
![æ—¥å¿—ç•Œé¢](https://vip.123pan.cn/1830392062/yk6baz03t0m000d7w33ga5rqxmls0ptkDIYwDdD2DqazDpxPDwJy.png)


## é¡¹ç›®ç”±æ¥

å·¥ä½œä¹‹åï¼Œå­¦ä¹ äº†Arcgisçš„ä½¿ç”¨ï¼Œå•ä½è€èµ„æ–™æ™®éæ˜¯ç”¨mapgis6.7åšçš„ï¼Œæƒ³è¦ä½¿ç”¨çš„è¯å°±éœ€è¦å…ˆè¿›è¡Œè½¬æ¢ï¼ŒæŸ¥é˜…åå‘ç°ç›®å‰çš„è½¬æ¢å·¥å…·ä¸»è¦å¦‚ä¸‹ï¼š

- **map2shp**ï¼šä¸€æ¬¾ç»å…¸çš„MapGISè½¬shapefileçš„å°å·¥å…·ï¼Œç•Œé¢ç®€æ´ï¼Œæ”¯æŒåŸºç¡€çš„æ–‡ä»¶è½¬æ¢ã€‚  
  **ä¼˜ç‚¹**ï¼šç›®å‰æ„Ÿè§‰æ˜¯è§è¿‡æœ€å®Œç¾çš„è½¬æ¢æ•ˆæœï¼Œæ”¯æŒæŠŠç¬¦å·éƒ½è½¬æ¢è¿‡æ¥ã€‚  
  **ç¼ºç‚¹**ï¼šä»·æ ¼æ˜‚è´µï¼Œä¸æ”¯æŒæ¯”ä¾‹è½¬æ¢ã€‚

- **FME**ï¼šåŠŸèƒ½å¼ºå¤§çš„å•†ä¸šæ•°æ®è½¬æ¢å¹³å°ï¼Œæ”¯æŒåŒ…æ‹¬MapGISåœ¨å†…çš„å¤šç§GISæ•°æ®æ ¼å¼è½¬æ¢ï¼Œé€‚åˆå¤§è§„æ¨¡ã€å¤æ‚æ•°æ®å¤„ç†ã€‚  
  **ä¼˜ç‚¹**ï¼šæ”¯æŒè‡ªå®šä¹‰ä¼ é€’çš„å­—æ®µå¹¶é‡å‘½åã€‚  
  **ç¼ºç‚¹**ï¼šä¸æ”¯æŒæ¯”ä¾‹è½¬æ¢ï¼Œä»·æ ¼æ˜‚è´µï¼Œmapgisçš„æ”¯æŒéœ€è¦å®‰è£…æ’ä»¶ï¼Œæ’ä»¶éœ€è¦ç”³è¯·ï¼Œæœ‰æ•ˆæœŸä¸€å¹´ã€‚

- **section**ï¼šå¼€æºçš„MapGISæ•°æ®å¤„ç†åº“ï¼Œæ”¯æŒMapGISæ–‡ä»¶çš„è¯»å–å’Œéƒ¨åˆ†è½¬æ¢æ“ä½œï¼Œé€‚åˆå¼€å‘è€…è¿›è¡ŒäºŒæ¬¡å¼€å‘å’Œå®šåˆ¶ã€‚  
  **ä¼˜ç‚¹**ï¼šä¸éœ€è¦é¢å¤–è£…è½¯ä»¶ã€‚  
  **ç¼ºç‚¹**ï¼šä¸æ”¯æŒè‡ªå¸¦å±æ€§ä¼ é€’ï¼Œéœ€è¦å…ˆå‚æ•°è½¬å±æ€§ï¼›ä¸æ”¯æŒæ¯”ä¾‹è½¬æ¢ã€‚

- **pymapgis**ï¼šPythonè¯­è¨€å®ç°çš„MapGISæ–‡ä»¶è§£æä¸è½¬æ¢åº“ï¼Œæ”¯æŒMapGISåˆ°shapefileç­‰æ ¼å¼çš„è½¬æ¢ï¼Œæ˜“äºé›†æˆåˆ°Pythoné¡¹ç›®ä¸­ï¼Œé€‚åˆè‡ªåŠ¨åŒ–å’Œæ‰¹é‡å¤„ç†åœºæ™¯ã€‚  
  **ä¼˜ç‚¹**ï¼šå¼€æºå…è´¹ï¼Œæ˜“äºè„šæœ¬åŒ–å’Œè‡ªåŠ¨åŒ–ï¼Œæ”¯æŒæ‰¹é‡å¤„ç†ï¼Œä¾¿äºè‡ªå®šä¹‰ä¿®æ”¹ã€‚  
  **ç¼ºç‚¹**ï¼šå­—æ®µæ–‡æœ¬å¤„ç†æœ‰é—®é¢˜ï¼Œè½¬æ¢æ•ˆç‡è¿‡æ…¢ã€‚


æ—©æœŸæ—¶å€™ç›´æ¥å¯¹pymapgisè¿›è¡Œä¿®æ”¹ï¼Œæ–°å¢è‡ªå¸¦å‚æ•°çš„å†™å…¥ï¼Œå› ä¸ºå•ä½çš„mapgisæ–‡ä»¶æœ‰æ ¼å¼å„æ ·çš„é—®é¢˜ï¼Œæ–°å¢äº†ç›´æ¥æŒ‡å®šåæ ‡ç³»å’Œæ¯”ä¾‹ç¼©æ”¾ã€‚åŸä½œè€…å¯¹mapgisæ–‡ä»¶çš„ç†è§£éå¸¸é€å½»ï¼Œè½¬æ¢çš„æ–‡ä»¶çŸ¢é‡åæ ‡å’Œå½¢çŠ¶ä¸å±æ€§æ²¡æœ‰é—®é¢˜ï¼Œä½†æ˜¯è½¬æ¢çš„æ—¶é—´ç‰¹åˆ«ä¹…ï¼Œæœ¬äººä¸æ˜¯ç§‘ç­å‡ºèº«ï¼Œå¯¹äºä¼˜åŒ–è¿™å—ä¹ŸæŸæ‰‹æ— ç­–ã€‚
AIç¼–ç¨‹é€æ¸æˆç†Ÿåï¼Œå°è¯•ç”¨cursorè¿›è¡Œä¼˜åŒ–å¤„ç†ï¼Œå‡ºä¹æ„æ–™çš„æ˜¯æ•ˆæœéå¸¸å¥½ï¼Œäºæ˜¯å°±å…¨éƒ¨é‡æ„ï¼Œå°è£…äº†ä¸ªUIç•Œé¢ï¼Œæœ‰äº†æ­¤é¡¹ç›®ã€‚


### ç›¸å¯¹äºåŸé¡¹ç›®é€»è¾‘æœ‰äº†ä»¥ä¸‹å˜åŠ¨ï¼š

- ğŸ› ï¸ ä¿®å¤éƒ¨åˆ†çŸ¢é‡é¢è½¬æ¢æ•°é‡å¼‚å¸¸é—®é¢˜
- âš¡ ä¼˜åŒ–é¢è¦ç´ èŠ‚ç‚¹è¿‡å¤šæ—¶çš„è½¬æ¢é€Ÿåº¦ï¼ˆå¦‚ï¼šæ€»ç»“ç‚¹çº¦5000ä¸ªçš„é¢æ–‡ä»¶ï¼Œä¼˜åŒ–å‰çº¦90ç§’ï¼Œä¼˜åŒ–åçº¦1ç§’ï¼‰
- ğŸ“ æ–°å¢æŒ‡å®šç¼©æ”¾æ¯”ä¾‹åŠŸèƒ½
- ğŸŒ æ–°å¢æŒ‡å®šåæ ‡ç³»åŠŸèƒ½
- ğŸš€ ä¼˜åŒ–åŸæœ‰è¯»å–é€»è¾‘ï¼Œå¤§å¹…æå‡è½¬æ¢é€Ÿåº¦ï¼ˆå¦‚ï¼šä¸€ä¸‡ä¸ªç‚¹çš„ç‚¹æ–‡ä»¶ï¼Œä¼˜åŒ–å‰çº¦2åˆ†é’Ÿï¼Œä¼˜åŒ–åçº¦1ç§’ï¼‰


## åŠŸèƒ½ç‰¹æ€§

- ğŸ—ºï¸ æ”¯æŒMapGISç‚¹ã€çº¿ã€é¢è¦ç´ çš„è½¬æ¢
- ğŸ”„ æ‰¹é‡æ–‡ä»¶è½¬æ¢åŠŸèƒ½
- ğŸ“ æ”¯æŒè‡ªå®šä¹‰æ¯”ä¾‹å°ºå’Œåæ ‡ç³»
- ğŸ¨ ç°ä»£åŒ–çš„PyQt5å›¾å½¢ç•Œé¢
- ğŸ“ è¯¦ç»†çš„è½¬æ¢æ—¥å¿—è®°å½•


## ä½¿ç”¨è¯´æ˜

### æ–¹å¼ä¸€ï¼šä¸‹è½½ç¼–è¯‘å¥½çš„è½¯ä»¶è¿è¡Œ

1. ä» [Releases](https://github.com/BenChao1998/ConvertMapGIS/releases) é¡µé¢ä¸‹è½½æœ€æ–°ç‰ˆæœ¬
2. è§£å‹åˆ°ä»»æ„ç›®å½•
3. åŒå‡»è¿è¡Œ `ConvertMapGIS.exe`

### æ–¹å¼äºŒï¼šæœ¬åœ°Pythonç¯å¢ƒè¿è¡Œ

#### ç¯å¢ƒè¦æ±‚
- Python 3.7+
- Windows/Linux/macOS

#### å®‰è£…æ­¥éª¤

1. å…‹éš†é¡¹ç›®
```bash
git clone https://github.com/BenChao1998/ConvertMapGIS.git
cd ConvertMapGIS
```

2. åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼ˆæ¨èï¼‰
```bash
python -m venv .venv
# Windows
.venv\Scripts\activate
```

3. å®‰è£…ä¾èµ–
```bash
pip install -r requirements.txt
```
4.è¿è¡Œç¨‹åº
```bash
python main.py
```


### å‘½ä»¤è¡Œä½¿ç”¨

#### åŸºæœ¬ç”¨æ³•
```python
from pymapgis import MapGisReader

# è¯»å–MapGISæ–‡ä»¶
reader = MapGisReader('your_file.wp', scale_factor=1000)

# è½¬æ¢ä¸ºShapefile
reader.to_file('output.shp', encoding='gb18030')
```

#### MapGisReader ç±»è¯¦è§£

**æ„é€ å‡½æ•°å‚æ•°ï¼š**
- `filepath` (str): MapGISæ–‡ä»¶è·¯å¾„
- `scale_factor` (int, å¯é€‰): ç¼©æ”¾æ¯”ä¾‹ï¼Œå¦‚1000è¡¨ç¤º1:1000æ¯”ä¾‹å°º
- `wkid` (int, å¯é€‰): æŠ•å½±åæ ‡ç³»WKIDï¼Œå¦‚4326è¡¨ç¤ºWGS84

**æ”¯æŒçš„æ–‡ä»¶ç±»å‹ï¼š**
- `.wp` - ç‚¹è¦ç´ æ–‡ä»¶
- `.wl` - çº¿è¦ç´ æ–‡ä»¶  
- `.wt` - é¢è¦ç´ æ–‡ä»¶

**ä¸»è¦æ–¹æ³•ï¼š**
- `to_file(filepath, **kwargs)`: å¯¼å‡ºä¸ºShapefileæ ¼å¼
- `__len__()`: è·å–è¦ç´ æ•°é‡
- `__str__()`: è·å–æ–‡ä»¶ä¿¡æ¯

#### ä½¿ç”¨ç¤ºä¾‹

**1. åŸºæœ¬è½¬æ¢**
```python
from pymapgis import MapGisReader

# è¯»å–ç‚¹è¦ç´ æ–‡ä»¶
reader = MapGisReader('points.wp')
reader.to_file('points.shp', encoding='gb18030')
```

**2. æŒ‡å®šåæ ‡ç³»**
```python
# ä½¿ç”¨ç¼©æ”¾æ¯”ä¾‹
reader = MapGisReader('lines.wl', scale_factor=5000)  # 1:5000æ¯”ä¾‹å°º
reader.to_file('lines.shp')

# ä½¿ç”¨æŠ•å½±åæ ‡ç³»
reader = MapGisReader('polygons.wt', wkid=4326)  # WGS84åæ ‡ç³»
reader.to_file('polygons.shp')
```

**3. æ‰¹é‡è½¬æ¢**
```python
import os
from pymapgis import MapGisReader

mapgis_files = ['file1.wp', 'file2.wl', 'file3.wt']
output_dir = 'output'

for file in mapgis_files:
    if os.path.exists(file):
        reader = MapGisReader(file, scale_factor=1000)
        output_file = os.path.join(output_dir, f"{os.path.splitext(file)[0]}.shp")
        reader.to_file(output_file, encoding='gb18030')
        print(f"è½¬æ¢å®Œæˆ: {file} -> {output_file}")
```

**4. ä¸Šä¸‹æ–‡ç®¡ç†å™¨ä½¿ç”¨**
```python
with MapGisReader('data.wp', scale_factor=1000) as reader:
    reader.to_file('data.shp', encoding='gb18030')
    print(f"è¦ç´ æ•°é‡: {len(reader)}")
```

## é¡¹ç›®ç»“æ„

```
ConvertMapGIS/
â”œâ”€â”€ main.py              # ä¸»ç¨‹åºå…¥å£ï¼ˆPyQt5 + QFluentWidgets GUIï¼‰
â”œâ”€â”€ pymapgis.py          # æ ¸å¿ƒè½¬æ¢åº“
â”œâ”€â”€ requirements.txt     # é¡¹ç›®ä¾èµ–
â”œâ”€â”€ README.md           # é¡¹ç›®è¯´æ˜
â””â”€â”€ resource/           # èµ„æºæ–‡ä»¶
    â”œâ”€â”€ *.png          # ç•Œé¢å›¾æ ‡
    â””â”€â”€ *.svg          # çŸ¢é‡å›¾æ ‡
```
## å¸¸è§é—®é¢˜

### Q: è½¬æ¢æŠ¥é”™ï¼Œæç¤ºæ•°é‡ä¸ä¸€è‡´
A: åœ¨sectionä¸­ï¼Œæ‰€æœ‰æ–‡ä»¶ç¼–è¾‘çŠ¶æ€ä¸‹ï¼Œå³é”®-å‹ç¼©ä¿å­˜å·¥ç¨‹ï¼Œé‡æ–°è½¬æ¢

### Q: æŒ‡å®šåæ ‡ç³»æ—¶ï¼Œwkidæ€ä¹ˆè·å–ï¼Ÿ
A: å¸¸è§wkid[æŸ¥è¯¢åœ°å€](https://blog.csdn.net/KK_bluebule/article/details/107334734)ã€‚

### Q: æŒ‡å®šåæ ‡ç³»æ—¶æ˜¯æ€ä¹ˆæ„æ€ï¼Ÿ
A:ä¸ºå½“å‰è½¬æ¢åçš„æ–‡ä»¶ç›´æ¥å†™å…¥åæ ‡ç³»ï¼Œç­‰åŒäºArcgisä¸­å®šä¹‰æŠ•å½±ã€‚

## è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ [GPLv3](LICENSE) è®¸å¯è¯è¿›è¡Œåˆ†å‘ã€‚

## è‡´è°¢

- åŸºäº [pymapgis](https://github.com/leecugb/pymapgis) é¡¹ç›®è¿›è¡Œå¼€å‘
- æ„Ÿè°¢åŸä½œè€… [leecugb](https://www.zhihu.com/people/cugb-93/posts) çš„è´¡çŒ®
- ä½¿ç”¨ [PyQt-Fluent-Widgets](https://github.com/zhiyiYo/PyQt-Fluent-Widgets) æ„å»ºç°ä»£åŒ–ç•Œé¢
- æ„Ÿè°¢ [zhiyiYo](https://github.com/zhiyiYo) å¼€å‘çš„ä¼˜ç§€UIç»„ä»¶åº“

[![pymapgis](https://github-readme-stats.vercel.app/api/pin/?username=leecugb&repo=pymapgis)](https://github.com/leecugb/pymapgis)
[![PyQt-Fluent-Widgets](https://github-readme-stats.vercel.app/api/pin/?username=zhiyiYo&repo=PyQt-Fluent-Widgets)](https://github.com/zhiyiYo/PyQt-Fluent-Widgets)

